Введение в Python 3
###################

:date: 2016-08-31 09:00

.. default-role:: code
.. contents:: Содержание

Введение
========

Данный курс будет посвящен изучению программирования с использованием языка **Python**. Python — это современный язык
программирования, работающий на всех распространённых операционных системах.

В настоящее время существует две версии языка Python: более старая, но пока ещё более распространённая версия 2 и
современная версия 3. Они не вполне совместимы друг с другом: программа, написанная для одной версии языка может
оказаться невыполнимой для другой версии. Но в основном обе версии очень похожи.

Мы будем использовать версию 3 данного языка, некоторые из используемых примеров не будут работать с версией 2.
Последняя версия языка, доступная в сентябре 2016 года — 3.5.2, именно её необходимо установить дома, скачав данную
версию с сайта www.python.org_.

.. _www.python.org: http://www.python.org

Запустить интерпретатор python можно из командной строки:

.. code-block:: bash

   python3

Будьте внимательны — команда `python` запустит интерпретатор версии 2, с которым мы работать не будем. В системе
Windows можно использовать пункт меню «Python (command line)».

IPython — расширенная оболочка
==============================

IPython — интерактивная оболочка для языка программирования Python, которая предоставляет расширенную интроспекцию,
дополнительный командный синтаксис, подсветку кода и автоматическое дополнение. Является компонентом пакета программ
SciPy.

IPython может использоваться как замена стандартной командной оболочки операционной системы, особенно на платформе
Windows, возможности оболочки которой ограничены. Поведение по умолчанию похоже на поведение оболочек UNIX-подобных
систем, но тот факт, что работа происходит в окружении Python, позволяет добиваться большей настраиваемости и
гибкости.

Для обучения возможностям Python лучше сразу использовать оболочку IPython_.

.. _IPython: http://ipython.org/


Итак, запустив оболочку IPython, Вы увидите примерно следующее приглашение командной строки:

.. code-block:: pycon

   Python 3.1.2 (r312:79147, Jun 12 2010, 15:29:06)
   [GCC 4.4.3 20100316 (ALT Linux 4.4.3-alt2)] on linux2
   Type "help", "copyright", "credits" or "license" for more information.
   >>>

Смело вводите команды и наслаждайтесь результатом. А что можно вводить? Несколько примеров:

.. code-block:: pycon

   >>> 2 + 2
   4
   >>> 2 ** 100
   1267650600228229401496703205376
   >>> 'Hello' + 'World'
   'HelloWorld'
   >>> 'ABC' * 10
   'ABCABCABCABCABCABCABCABCABCABC'

Первая команда вычисляет сумму двух чисел, вторая команда вычисляет 2 в степени 100, третья команда выполняет операцию
**конкатенации** для строк, а четвертая команда печатает строку `'ABC'`, повторенную 10 раз.

Хотите закончить работу с питоном? Введите команду `exit()` (именно так, со скобочками, так как это — **функция**)
или нажмите ``Ctrl+D``.

Типы данных
===========

Итак, мы видим, что Python умеет работать как минимум с двумя видами данных — числами и строками. Числа записываются
последовательностью цифр, также перед числом может стоять знак минус, а строки записываются в одинарных кавычках. `2`
и `'2'` — это разные объекты, первый объект — число, а второй — строка. Операция ``+`` для целых чисел и для строк
работает по-разному: для чисел это сложение, а для строк — конкатенация.

Кроме целых чисел есть и другой класс чисел: действительные (вещественные числа), представляемые в виде десятичных
дробей. Они записываются с использованием десятичной точки, например, `2.0`. В каком-то смысле, `2` и `2.0`
имеют равные значение, но это — разные объекты. Например, можно вычислить значения выражения `'ABC'*10` (повторить
строку 10 раз), но нельзя вычислить `'ABC'*10.0`.

Определить тип объекта можно при помощи функции `type`:

.. code-block:: pycon

   >>> type(2)
   <class 'int'>
   >>> type('2')
   <class 'str'>
   >>> type(2.0)
   <class 'float'>

Обратите внимание — `type` является функцией, аргументы функции указываются в скобках после ее имени.

Вот список основных операций для чисел:

- `A+B` — сумма;
- `A-B` — разность;
- `A*B` — произведение;
- `A/B` — частное;
- `A**B` — возведение в степень.

Полезно помнить, что квадратный корень из числа ``x`` — это `x**0.5`, а корень степени ``n`` — это `x**(1/n)`.

Есть также унарный вариант операции ``-``, то есть операция с одним аргументом. Она возвращает число, противоположное
данному. Например: `-A`.

В выражении может встречаться много операций подряд. Как в этом случае определяется порядок действий? Например, чему
будет равно `1+2*3**1+1`? В данном случае ответ будет 8, так как сначала выполняется возведение в степень, затем —
умножение, затем —  сложение.

Более общие правила определения приоритетов операций такие:

#. Выполняются возведения в степень  **справа налево**, то есть `3**3**3` это 3²⁷.
#. Выполняются унарные минусы (отрицания).
#. Выполняются умножения и деления слева направо. Операции умножения и деления имеют одинаковый приоритет.
#. Выполняются сложения и вычитания слева направо. Операции сложения и вычитания имеют одинаковый приоритет.

Основные операции над строками:

- `A+B` — конкатенация;
- `A*n` — повторение ``n`` раз, значение ``n`` должно быть целого типа.


Упражнение №1: возведение в степень
-----------------------------------

Вычислите 2¹⁷⁹.

Упражнение №2: гипотенуза
-------------------------

Вычислите длину гипотенузы в прямоугольном треугольнике со сторонами 179 и 971.


Преобразование типов
====================

Иногда бывает полезно целое число записать, как строку. И, наоборот, если строка состоит из цифр, то полезно эту строку
представить в виде числа, чтобы дальше можно было выполнять арифметические операции с ним. Для этого используются
функции, одноименные с типом, то есть `int`, `float`,  `str`. Например, `int('123')` вернет целое число `123`, а
`str(123)` вернет строку `'123'`.

Пример:

.. code-block:: pycon

   >>> str(2 + 2) * int('2' + '2')
   '4444444444444444444444'

Результатом будет строка из числа ``4``, повторенная ``22`` раза.

Пишем простейшие программы
==========================

Использование правильных инструментов
-------------------------------------

Давайте отвлечёмся на некоторое время от языка Python и поговорим о другом немаловажном аспекте программирования — об
использовании правильных инструментов для разработки. В рамках этого курса нам предстоит использовать два типа
инструментов: это система контроля версий и среда разработки. Зачастую от неверного выбора используемого инструментария
существенно может снизиться производительность работы, да и удобство использования инструментов тоже может заметно
отличаться. Так, забивать гвоздь микроскопом явно не стоит.

Современные реалии таковы, что даже в рамках одного стека технологий практически всегда присутствует возможность выбора
инструментов. Обратитесь к своему преподавателю, чтобы он рассказал о системе контроля версий и среде разработки,
которые будут использоваться в рамках курса.

Полезные ссылки:

* `github.com`__
* `обучение использованию github.com`__
* `обучение использованию git`__

.. __: https://github.com
.. __: https://try.github.io
.. __: https://githowto.com/ru

Возвращаемся к программированию
-------------------------------

В предыдущем задании мы использовали Python для простых разовых вычислений, используя интерактивный режим. Например,
было задание вычислить длину гипотенузы прямоугольного треугольника по её катетам. Решение этой задачи можно записать
следующим образом:

.. code-block:: python

   a = 179
   b = 197
   c = (a ** 2 + b ** 2) ** 0.5
   print (c)

Здесь мы используем  **переменные** — объекты, в которых можно сохранять различные (числовые, строковые и прочие)
значения. В первой строке переменной `a` присваивается значение `179`, затем переменной `b` присваивается значение
`971`, затем переменной `c` присваивается значение арифметического выражения, равного длине гипотенузы. После этого
значение переменной `c` выводится на экран.

Сохраните этот текст в файле с именем `hypot.py`. Запустите терминал, перейдите в каталог, где лежит этот файл и
выполните эту программу:

.. code-block:: bash

   python3 hypot.py

Интерпретатор языка Python, запущенный с указанием имени файла, запускается не в интерактивном режиме, а выполняет ту
последовательность команд, которая сохранена в файле. При этом значения вычисленных выражений не выводятся на экран (в
отличии от интерактивного режима), поэтому для того, чтобы вывести результат работы программы, то есть значение
переменной `c`, нам понадобится специальная функция `print`.

Ввод данных: функция `input()`
==============================

Пример выше неудобен тем, что исходные данные для программы заданы в тексте программы, и для того, чтобы использовать
программу для другого треугольника необходимо исправлять текст программы. Это неудобно, лучше, чтобы текст программы не
менялся, а программа запрашивала бы у пользователя данные, необходимые для решения задачи, то есть запрашивала бы
значения двух исходных переменных `a` и `b`. Для этого будем использовать функцию `input()`, которая считывает строку с
клавиатуры и возвращает значение считанной строки, которое сразу же присвоим переменным `a` и `b`:

.. code-block:: python

   a = input()
   b = input()

Правда, функция `input` возвращает текстовую строку, а нам нужно сделать так, чтобы переменные имели целочисленные
значения. Поэтому сразу же после считывания выполним преобразование типов при помощи функции `int` и запишем новые
значения в переменные `a` и `b`.

.. code-block:: python

   a = int(a)
   b = int(b)


Можно объединить считывание строк и преобразование типов, если вызывать функцию `int` для того значения, которое вернёт
функция `input`:

.. code-block:: python

   a = int(input())
   b = int(input())

Далее в программе вычислим значение переменной `c` и выведем результат на экран.

Теперь мы можем, не меняя исходного кода программы, многократно использовать её для решения различных задач. Для того
нужно запустить программу и после запуска программы ввести с клавиатуры два числа, нажимая после каждого числа клавишу
`Enter`. Затем программа сама выведет результат.

Вывод данных: функция `print()`
===============================

Функция `print` может выводить не только значения переменных, но и значения любых выражений. Например, допустима запись
`print(2 + 2 ** 2)`. Также при помощи функции `print` можно выводить значение не одного, а нескольких выражений, для
этого нужно перечислить их через запятую:

.. code-block:: python

   a = 1
   b = 2
   print(a, '+', b, '=', a + b)

В данном случае будет напечатан текст `1 + 2 = 3`: сначала выводится значение переменной `a`, затем строка из знака `+`,
затем  значение переменной `b`, затем строка из знака `=`, наконец, значение суммы `a + b`.

Обратите внимание, выводимые значения разделяются одним пробелом. Но такое поведение можно изменить: можно разделять
выводимые значения двумя пробелами, любым другим символом, любой другой строкой, выводить их в отдельных строках или не
разделять никак. Для этого нужно функции `print` передать специальный именованный параметр, называемый `sep`, равный
строке, используемый в качестве разделителя (sep —  сокращение слова separator, т.е. разделитель). По умолчанию
параметр `sep` равен строке из одного пробела и между значениями выводится пробел. Чтобы использовать в качестве
разделителя, например, символ двоеточия нужно передать параметр `sep`, равный строке `':'`:

.. code-block:: python

   print(a, b, c, sep = ':')

Аналогично, для того, чтобы совсем убрать разделитель при выводе нужно передать параметр `sep`, равный пустой строке:

.. code-block:: python

   print(a, '+', b, '=', a + b, sep = '')

Для того, чтобы значения выводились с новой строки, нужно в качестве параметра `sep` передать строку, состоящую из
специального символа новой строки, которая задаётся так:

.. code-block:: python

   print(a, b, sep = '\n')

Символ обратного слэша в текстовых строках является указанием на обозначение специального символа, в зависимости
от того, какой символ записан после него. Наиболее часто употребляется символ новой строки `'\n'`.
А для того, чтобы вставить в строку сам символ обратного слэша, нужно повторить его два раза: `'\\'`.

Вторым полезным именованным параметром функции `print` является параметр `end`,
который указывает на то, что выводится после вывода всех значений, перечисленных в функции `print`.
По умолчанию параметр `end` равен `'\n'`, то есть следующий вывод будет происходить
с новой строки. Этот параметр также можно исправить, например, для того, чтобы убрать все дополнительные
выводимые символы можно вызывать функцию `print` так:

.. code-block:: python

   print(a, b, c, sep = '', end = '')

Упражнение №3: гипотенуза с пользовательским вводом
---------------------------------------------------

Дано два числа `a` и `b`. Выведите гипотенузу треугольника с заданными катетами.

+------+-------+
| Ввод | Вывод |
+======+=======+
| 3    | 5     |
+------+-------+
| 4    |       |
+------+-------+

Упражнение №4: следующее и предыдущее
-------------------------------------

Напишите программу, которая считывает целое число и выводит текст, аналогичный приведённому в примере:

+------+-------------------------------------------------+
| Ввод | Вывод                                           |
+======+=================================================+
| 2015 | The next number for the number 2015 is 2016     |
+------+-------------------------------------------------+
|      | The previous number for the number 2015 is 2014 |
+------+-------------------------------------------------+


Целочисленная арифметика
========================

Для целых чисел определены ранее рассматривавшиеся операции `+`, `-`, `*` и `**`. Операция деления `/` для целых чисел
возвращает значение типа `float`. Также функция возведения в степень возвращает значение типа `float`, если показатель
степени — отрицательное число.

Но есть и специальная операция целочисленного деления, выполняющегося с отбрасыванием дробной части, которая
обозначается `//`. Она возвращает целое число: целую часть частного. Например:

.. code-block:: pycon

   >>> 17 // 3
   5
   >>> -17 // 3
   -6

Другая близкая ей операция — это операция взятия остатка от деления, обозначаемая `%`:

.. code-block:: pycon

   >>> 17 % 3
   2
   >>> -17 % 3
   1

Упражнение №5: последняя цифра
------------------------------

Дано натуральное число. Выведите его последнюю цифру. Пример:

+------+-------+
| Ввод | Вывод |
+======+=======+
| 179  | 9     |
+------+-------+


Упражнение №6: число десятков
-----------------------------

Дано натуральное число. Найдите число десятков в его десятичной записи (то есть вторую справа цифру его десятичной
записи). Пример:

+------+-------+
| Ввод | Вывод |
+======+=======+
| 179  | 7     |
+------+-------+


Строки
======

Строка считывается со стандартного ввода функцией `input()`. Напомним, что для двух строк определена операция сложения
(конкатенации), также определена операция умножения строки на число.

Строка состоит из последовательности символов. Узнать количество символов (длину строки) можно при помощи функции `len`:


.. code-block:: pycon

   >>> S = 'Hello'
   >>> print(len(S))
   5

Срезы (slices)
==============

Срез (slice) — извлечение из данной строки одного символа или некоторого фрагмента подстроки или подпоследовательности.

Есть три формы срезов. Самая простая форма среза: взятие одного символа строки, а именно, `S[i]` — это срез, состоящий
из одного символа, который имеет номер `i`, при этом считая, что нумерация начинается с числа 0. То есть если
`S='Hello'`, то `S[0]=='H'`, `S[1]=='e'`, `S[2]=='l'`, `S[3]=='l'`, `S[4]=='o'`.

Номера символов в строке (а также в других структурах данных: списках, кортежах) называются **индексом**.

Если указать отрицательное значение индекса, то номер будет отсчитываться с конца, начиная с номера `-1`. То есть
`S[-1]=='o'`, `S[-2]=='l'`, `S[-3]=='l'`, `S[-4]=='e'`, `S[-5]=='H'`.


Или в виде таблицы:

+----------+-------+-------+-------+-------+-------+
| Строка S | H     | e     | l     | l     | o     |
+==========+=======+=======+=======+=======+=======+
| Индекс   | S[0]  | S[1]  | S[2]  | S[3]  | S[4]  |
+----------+-------+-------+-------+-------+-------+
| Индекс   | S[-5] | S[-4] | S[-3] | S[-2] | S[-1] |
+----------+-------+-------+-------+-------+-------+

Если же номер символа в срезе строки `S` больше либо равен `len(S)`, или меньше, чем `-len(S)`, то при обращении к этому
символу строки произойдёт ошибка `IndexError: string index out of range`.

Срез с двумя параметрами: `S[a:b]` возвращает подстроку из `b-a` символов, начиная с символа с индексом `a`, то есть до
символа с индексом `b`, не включая его. Например, `S[1:4]=='ell'`, то же самое получится если написать `S[-4:-1]`. Можно
использовать как положительные, так и отрицательные индексы в одном срезе, например, `S[1:-1]` —  это строка без первого
и последнего символа (срез начинается с символа с индексом 1 и  заканчивается индексом -1, не включая его).

При использовании такой формы среза ошибки `IndexError` никогда не возникает. Например, срез `S[1:5]` вернёт строку
`'ello'`, таким же будет результат, если сделать второй индекс очень большим, например, `S[1:100]` (если в строке не
более 5 символов).

Если опустить второй параметр (но поставить двоеточие), то срез берётся до конца строки. Например, чтобы удалить из
строки первый символ (его индекс равен 0, то есть взять срез, начиная с символа с индексом 1), то можно взять срез
`S[1:]`, аналогично если опустить первый параметр, то срез берётся от начала строки. То есть удалить из строки
последний символ можно при помощи среза `S[:-1]`. Срез `S[:]` совпадает с самой строкой `S`.

Если задать срез с тремя параметрами `S[a:b:d]`, то третий параметр задаёт шаг, как в случае с функцией `range`, то есть
будут взяты символы с индексами `a`, `a+d`, `a+2*d` и т.д. При задании значения третьего параметра, равному 2, в срез
попадёт каждый второй символ, а если взять значение среза, равное `-1`, то символы будут идти в обратном порядке.

Методы
======

Метод — это функция, применяемая к объекту, в данном случае — к строке. Метод вызывается в виде
`Имя_объекта.Имя_метода(параметры)`. Например, `S.find("e")` — это применение к строке `S` метода `find` с одним
параметром `"e"`.

Метод `find` находит в данной строке (к которой применяется  метод) данную подстроку (которая передаётся в качестве
параметра). Функция возвращает индекс первого вхождения искомой подстроки. Если же подстрока не найдена, то метод
возвращает значение -1. Например:

.. code-block:: pycon

   >>> S = 'Hello'
   >>> print(S.find('e'))
   1
   >>> print(S.find('ll'))
   2
   >>> print(S.find('L'))
   -1

Аналогично, метод `rfind` возвращает индекс последнего вхождения данной строки («поиск справа»).

.. code-block:: pycon

   >>> S = 'Hello'
   >>> print(S.find('l'))
   2
   >>> print(S.rfind('l'))
   3

Если вызвать метод `find` с тремя параметрами `S.find(T, a, b)`, то поиск будет осуществляться в срезе `S[a:b]`. Если
указать только два параметра `S.find(T, a)`, то поиск будет осуществляться в срезе `S[a:]`, то есть начиная с символа с
индексом `a` и до конца строки. Метод `S.find(T, a, b)` возвращает индекс в строке `S`, а не индекс относительно начала
среза.

Метод `replace` заменяет все вхождения одной строки на другую. Формат: `S.replace(old, new)` — заменить в строке `S` все
вхождения подстроки `old` на подстроку `new`. Пример:

.. code-block:: pycon

   >>> 'Hello'.replace('l', 'L')
   'HeLLo'

Если методу `replace` задать ещё один параметр: `S.replace(old, new, count)`, то заменены будут не все вхождения, а
только не больше, чем первые `count` из них.

.. code-block:: pycon

   >>> 'Abrakadabra'.replace('a', 'A', 2)
   'AbrAkAdabra'

Метод `count` подсчитывает количество вхождений одной строки в другую строку. Простейшая форма вызова `S.count(T)`
возвращает число вхождений строки `T` внутри строки `S`. При этом подсчитываются только непересекающиеся вхождения,
например:

.. code-block:: pycon

   >>> 'Abracadabra'.count('a')
   4
   >>> ('a' * 100000).count('aa')
   50000

При указании трёх параметров `S.count(T, a, b)`, будет выполнен подсчёт числа вхождений строки `T` в срез `S[a:b]`.

Упражнение №7: срезы
--------------------

Дана строка. Последовательно на разных строках выведите:

- третий символ этой строки;
- предпоследний символ этой строки;
- первые пять символов этой строки;
- всю строку, кроме последних двух символов;
- все символы с чётными индексами (считая, что индексация начинается с 0, поэтому символы выводятся начиная с первого);
- все символы с нечётными индексами, то есть начиная со второго символа строки;
- все символы в обратном порядке.
- все символы строки через один в обратном порядке, начиная с последнего;
- длину данной строки.

Пример:

 +-------------+-------------+
 | Ввод        | вывод       |
 +=============+=============+
 | Абракадабра | р           |
 +-------------+-------------+
 |             | р           |
 +-------------+-------------+
 |             | Абрак       |
 +-------------+-------------+
 |             | Абракадаб   |
 +-------------+-------------+
 |             | Аркдба      |
 +-------------+-------------+
 |             | бааар       |
 +-------------+-------------+
 |             | арбадакарбА |
 +-------------+-------------+
 |             | абдкрА      |
 +-------------+-------------+
 |             | 11          |
 +-------------+-------------+


Упражнение №8: количество слов
-------------------------------

Дана строка, состоящая из слов, разделённых пробелами. Определите, сколько в ней слов. Используйте для решения задачи
метод `count`. Пример:

+-------------+-------+
| Ввод        | Вывод |
+=============+=======+
| Hello world | 2     |
+-------------+-------+


Упражнение №9\*: вставить \*
----------------------------

Получите новую строку, вставив между двумя символами исходной строки символ \*. Выведите полученную строку. Пример:

+--------+------------------+
| Ввод   | Вывод            |
+========+==================+
| python | p\*y\*t\*h\*o\*n |
+--------+------------------+


Упражнение №10\*: заменить символы, но не все
---------------------------------------------

Замените в строке все появления буквы h на букву H, кроме первого и последнего вхождения. Пример:

+-----------+-----------+
| Ввод      | Вывод     |
+===========+===========+
| aahhhhhbb | aahHHHhbb |
+-----------+-----------+


PEP 8 — руководство по написанию кода на Python
===============================================

PEP 8 создан на основе рекомендаций `Гвидо ван Россума`_ — создателя языка Python.

.. _`Гвидо ван Россума`: https://ru.wikipedia.org/wiki/%D0%A0%D0%BE%D1%81%D1%81%D1%83%D0%BC,_%D0%93%D0%B2%D0%B8%D0%B4%D0%BE_%D0%B2%D0%B0%D0%BD


Ключевая идея Гвидо такова: **код читается намного больше раз, чем пишется**. Собственно, рекомендации о стиле написания
кода направлены на то, чтобы улучшить читаемость кода и сделать его согласованным между большим числом проектов. В
идеале, весь код будет написан в едином стиле, и любой сможет легко его прочесть.

На русском можно прочитать про PEP8 тут_, на английском — здесь_.

.. _тут: http://pythonworld.ru/osnovy/pep-8-rukovodstvo-po-napisaniyu-koda-na-python.html
.. _здесь: https://www.python.org/dev/peps/pep-0008/">https://www.python.org/dev/peps/pep-0008/
