Штрилиц
#######

:date: 2016-04-11
:status: draft


.. default-role:: code
.. contents:: Содержание

Описание работы
===============

Данная работа посвящена шифрованию и расшифровке шифротекстов, закодированных простыми классическими шифрами.

Расшифровка текста
==================

Для хранения и передачи секретных данных требуется либо использовать защищённый канал связи, либо опеспечить шифрование самого сообщения, чтобы даже при его перехвате злоумышленник не смог его прочитать. Наука о шифровании данных называется `криптография`__. (Существует ещё вариант сокрытия самого факта передачи информации — стеганография.)

.. __:	https://ru.wikipedia.org/wiki/%D0%9A%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%8F


Атбаш
-----

Атбаш — это шифр простой замены, использованный для еврейского алфавита и получивший оттуда своё название. Шифрование происходит заменой первой буквы алфавита на последнюю, второй на предпоследнюю и так далее.

Для русского алфавита таблица замен:

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|а|б|в|г|д|е|ё|ж|з|и|й|к|л|м|н|о|п|р|с|т|у|ф|х|ц|ч|ш|щ|ъ|ы|ь|э|ю|я|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|я|ю|э|ь|ы|ъ|щ|ш|ч|ц|х|ф|у|т|с|р|п|о|н|м|л|к|й|и|з|ж|ё|е|д|г|в|б|а|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Данный шифр тривиален для взлома, поскольку у него нет ключа. Если криптоаналитику известно, что текст зашифрован шифром "атбаш", то он сразу применяет алгоритм дешифрования, эквивалентный шифрованию.

Программа для шифрования шифром "атбаш":

.. code-block:: python

	__author__ = 'Timofey Khirianov'
	# -*- coding: utf8 -*-


	class Atbash:
	    alphabet = "абвгдеёжзийклмнопрстуфхцчшщъыьэюя"

	    def __init__(self):
	        lowercase_code = {self.alphabet[i]:self.alphabet[-i-1] for i in range(len(self.alphabet))}
	        uppercase_code = {self.alphabet[i].upper():self.alphabet[-i-1].upper() for i in range(len(self.alphabet))}
	        self._encode = dict(lowercase_code)
	        self._encode.update(uppercase_code)

	    def encode(self, line):
	        if len(line) == 1:
	            return self._encode[line] if line in self._encode else line
	        else:
	            return ''.join([self.encode(char) for char in line])


	cipher = Atbash()
	line = input()
	while line != '.':
	    print(cipher.encode(line))
	    line = input()

Следующий раздел лабораторной работы закодирован шифром "атбаш".

Жцко Иъчяоа
-----------

Жцко Иъчяоа — вмр эцы жцкоя прынмясрэфц, э фрмрорт фяшыдх нцтэру э рмфодмрт мъфнмъ чятъсаъмна нцтэрурт, сяйрыаёцтна ся съфрмрорт прнмрассрт зцнуъ прчцицх уъэъъ цуц пояэъъ съьр э яукяэцмъ. Сяпоцтъо, э жцкоъ нр ныэцьрт эпояэр ся 3, Я юдуя юд чятъсъся ся Ь, Ю нмясъм Ы, ц мяф ыяуъъ.

Жцко сячэяс э зънмг оцтнфрьр цтпъоямроя Ьяа Буца Иъчяоа, цнпругчрэяэжъьр ъьр ыуа нъфоъмсрх пъоъпцнфц нр нэрцтц ьъсъояуятц.

Нуъылбёяа зянмг ояюрмд чяжцкорэяся жцкорт Иъчяоа.

.. code-block:: python

	__author__ = 'Timofey Khirianov'
	# -*- coding: utf8 -*-


	class Caesar:
	    alphabet = "яюэьыъщшчцхфутсрпонмлкйизжёедгвба"

	    def __init__(self, key):
	        lowercase_code = {self.alphabet[i]:self.alphabet[(i+key)%len(self.alphabet)] for i in range(len(self.alphabet))}
	        uppercase_code = {self.alphabet[i].upper():self.alphabet[(i+key)%len(self.alphabet)].upper() for i in range(len(self.alphabet))}
	        self._encode = dict(lowercase_code)
	        self._encode.update(uppercase_code)
	        self._decode = {y: x for x, y in self._encode.items()}

	    def encode(self, line):
	        if len(line) == 1:
	            return self._encode[line] if line in self._encode else line
	        else:
	            return ''.join([self.encode(char) for char in line])

	    def decode(self, line):
	    	pass  # FIXME


	key = int(input('Ээъыцмъ фубз:'))
	cipher = Caesar(key)
	line = input()
	while line:
	    print(cipher.encode(line))
	    line = input()

Ырпцжцмъ тъмры decode ц оянжцколхмъ нуъылбёцх оячыъу уяюроямросрх ояюрмд.
Прылтяхмъ, прзътл эят съ нррюёцуц фубз жцкорэясца ц змр эят н вмцт ыъуямг.


Ищеб абявгяъ шрэхюл
-------------------

Аяшфбртьпхэ в брвищебятыяъ бршфхьр!

Щгры, тл фяурфрьщвм аязхэд ищеб Жхшрбп юх птьпхгвп ыбщагявгяъыщэ: вьщиыяэ эрьр эяйюявгм эюячхвгтр ыьозхъ щ
юдчюлъ ыьоз ьхуыя юръгщ эхгяфяэ аяьюяуя ахбхсябр.

Эячюя ьщ дтхьщзщгм ыбщагявгяъыявгм, юх эхюпп эхгяф ищебятрющп? Фр, эячюя. Хвьщ шрэхюпгм яфщю вщэтяь рьертщгр
юр яабхфхьцююлъ фбдуяъ вщэтяь гяуя чх рьертщгр ая ырыяъ-гя грсьщжх шрэхю, гя врэр грсьщжр шрэхю щ птьпхгвп ыьозяэ.

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|р|с|т|у|ф|х|ц|ч|ш|щ|ъ|ы|ь|э|ю|я|а|б|в|г|д|е|ё|ж|з|и|й|к|л|м|н|о|п|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|м|ш|ж|т|ы|с|й|ё|е|а|б|п|ь|н|р|х|л|и|д|э|к|ч|ц|я|у|ъ|ю|ф|щ|г|з|о|в|


Эюячхвгтя ыьозхъ — нгя эюячхвгтя тяшэячюлё грсьщж абявглё шрэхю.
Фьп бдввыяуя рьертщгр эяйюявгм эюячхвгтр грсьщж абявглё шрэхю бртюр ерыгябщрьд яг 33.
33! = 8683317618811886495518194401280000000

Хвьщ гбргщгм юр абятхбыд яфюяуя трбщрюгр 0.000001 вхыдюфл, аяьдзщгвп 2.8e+23 ьхг...
Эячхг аяыршргмвп, згя ищеб абявгяъ шрэхюл таяьюх ыбщагявгяъыщъ, яфюрыя нгя юх гры.

Хуя фявгргязюя абявгя тшьяэргм абщ аяэяйщ `зрвгягюяуя рюрьщшр`__. Фхья т гяэ, згя зрвгягр аяптьхющп шрфрююяъ
сдытл рьертщгр т фявгргязюя фьщююлё гхывгрё яфюр щ гр чх фьп бршюлё гхывгят яфюяуя пшлыр.
Хвьщ т ищебягхывгх сдфхг вщэтяь в тхбяпгюявгмо аяптьхющп, рюрьяущзюяъ вгрюфрбгюяъ фьп пшлыр, гя эячюя абхфаяьячщгм, згя яю щ птьпхгвп дыршрююяъ шрищебятрююяъ сдытяъ.

.. __: https://ru.wikipedia.org/wiki/%D0%A7%D0%B0%D1%81%D1%82%D0%BE%D1%82%D0%BD%D1%8B%D0%B9_%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7

Эхгяф зрвгягюяуя ыбщагярюрьщшр щштхвгхю в IX-уя тхыр (брсягл Рь-Ыщюфщ), ёягп юрщсяьхх щштхвгюлэ вьдзрхэ хуя абщэхюхющп т бхрьмюяъ чщшющ, тяшэячюя, птьпхгвп фхищебятыр хущахгвыщё щхбяуьщеят Ч.-Е. Ирэаяьмяюяэ т 1822 уяфд. Т ёдфячхвгтхююяъ ьщгхбргдбх юрщсяьхх щштхвгюлэщ даяэщюрющпэщ птьпогвп брввыршл «Шяьягяъ чды» Нфурбр Ая, «Аьпидйщх зхьятхзыщ» Ыяюрю Фяъьп, р грычх бяэрю «Фхгщ ыращгрюр Убрюгр» Чоьм Тхбюр.

Щгры, вьхфдойрп зрвгм брсягл шрищебятрюр абщ аяэяйщ вьхфдойхъ абяубрээл:

	import random
	__author__ = 'Timofey Khirianov'
	# -*- coding: utf8 -*-


	class Monoalphabet:
	    alphabet = "рстуфхцчшщъыьэюяабвгдеёжзийклмноп"

	    def __init__(self, keytable):
	        lowercase_code = {self.alphabet[i]:keytable[i] for i in range(len(self.alphabet))}
	        uppercase_code = {self.alphabet[i].upper():keytable[i].upper() for i in range(len(self.alphabet))}
	        self._encode = dict(lowercase_code)
	        self._encode.update(uppercase_code)
	        self._decode = {y: x for x, y in self._encode.items()}

	    def encode(self, line):
	        if len(line) == 1:
	            return self._encode[line] if line in self._encode else line
	        else:
	            return ''.join([self.encode(char) for char in line])

	    def decode(self, line):
	        if len(line) == 1:
	            return self._decode[line] if line in self._decode else line
	        else:
	            return ''.join([self.decode(char) for char in line])


	key = Monoalphabet.alphabet[:]
	random.shuffle(key)
	cipher = Monoalphabet(key)
	line = input()
	while line:
	    print(cipher.encode(line))
	    line = input()

Згя чх трэ фхьргм?.. Эячхг слгм ягыршргмвп яг тлаяьюхющп брсягл щ аяьдзщгм фтр?
Щьщ абхфвгртщгм вхсп Ихбьяыяэ Ёяьэвяэ, ыягяблъ абщэхющг втяъ шюрэхющглъ эхгяф фхфдыжщщ?
Тлсяб шр трэщ!

Абяубрээд фьп зрвгягюяуя рюрьщшр вьхфдхг юращвргм врэявгяпгхьмюя. Двахёят!

Жйрв илойчорчъйыалэ ьчздац
--------------------------

Счояадэжйз ивлслоедайдз жйрвлъ ивлюылэ ьчздац ёъоёдыюё залглчорчъйыацд жйрвц. Чнх Чоя-Шйасй ъ юълйф вчнлычф илшчьчо, пыл лнцпацд злалчорчъйыацд жйрвц слълояал-ычшй ивлюыл илссчуыюё пчюылыалзх швйиылчачойьх й идвъцз ивдсолейо йюилояьлъчыя залглчорчъйыацд жйрвц. Ъ Дъвлид ычшйд жйрвц нцой ъидвъцд лийючац ъ 1467 глсх йычояёаюшйз чвфйыдшылвлз Одла Нчыыйюыч Чояндвый. Ъ XVI ъдшд адздбшйэ чннчы Йлгчаа Ывйыдзйэ ъ юълдэ шайгд “Юыдалгвчрйё” ивдсюычъйо юфдзх илойчорчъйыалгл жйрвлъчайё ъ ъйсд ычнойбц. Нлодд юолеацэ ъчвйчаы ю йюилояьлъчайдз юзджчаацф чорчъйылъ нцо лийюча ъ 1563 глсх Сечзнчыыйюыч сдооч Илвыч ъ дгл шайгд “Ивл юшвцыху ьачпйзлюыя лысдояацф нхшъ”. Илюодсайз юолълз ъ вчьъйыйй илойчорчъйыацф жйрвлъ злеал юпйычыя влылвацд зчжйац, ивйздвлз шлылвлэ злеал юпйычыя адздбшху зчжйах Enigma[10], вчьвчнлычаачё ъ 1917 г. Юхыя илойчорчъйыацф жйрвлъ ьчшоупдач ъ залглшвчыалз ивйздадайй вчьойпацф жйрвлъ ивлюылэ ьчздац ш ливдсдодаалзх пйюох нхшъ жйрвхдзлгл ыдшюыч. Ыл дюыя ш шчеслэ нхшъд ил лысдояалюый ивйздаёдыюё лсйа йь жйрвлъ ивлюылэ ьчздац.

Ивйздвц илойчорчъйыацф жйрвлъ:

* Жйрв Ъйедадвч
* Жйрв Ъдвачзч (лсалвчьлъцэ нолшалы)

Жйрв Ъйедадвч юлюылйы йь илюодслъчыдояалюый адюшлояшйф жйрвлъ Бдьчвё ю вчьойпацзй ьачпдайёзй юсъйгч. Соё ьчжйрвлъцъчайё зледы йюилояьлъчыяюё ычнойбч чорчъйылъ, ачьцъчдзчё шъчсвчы (ычнойбч) Ъйедадвч. Ивйздайыдояал ш очыйаюшлзх чорчъйых ычнойбч Ъйедадвч юлюычъоёдыюё йь юывлш ил 26 юйзълолъ, ивйпмз шчесчё юодсхущчё юывлшч юсъйгчдыюё ач адюшлояшл ильйбйэ. Ычшйз лнвчьлз, ъ ычнойбд илохпчдыюё 26 вчьойпацф жйрвлъ Бдьчвё. Ач вчьацф кычичф шлсйвлъшй жйрв Ъйедадвч йюилояьхды вчьойпацд чорчъйыц йь кылэ ычнойбц. Ач шчеслз кычид жйрвлъчайё йюилояьхуыюё вчьойпацд чорчъйыц, ъцнйвчдзцд ъ ьчъйюйзлюый лы юйзълоч шоупдългл юолъч. Ачивйздв, дюой шоупдълд юолъл “ЮЧЫ”, ыл идвъчё нхшъч лышвцылгл ыдшюыч жйрвхдыюё ю йюилояьлъчайдз чорчъйыч “Ю’, ъылвчё “Ч”, ывдыяё “Ы”, пдыъмвычё юалъч “Ю” й ычш счодд.

Кылы ыйи жйрвч илсюычалъшй слълояал юидбйрйпдюшйэ. Ла нцо йьлнвдыда ъ шлабд идвълэ зйвлълэ ълэац Гйондвылз Ъдвачзлз. Шолс Ждаала зчыдзчыйпдюшй слшчьчо дгл чнюлоуыаху швйиылгвчрйпдюшху юылэшлюыя ъ юълдэ вчнлыд 1945 глсч. Соё юльсчайё жйрвлыдшюыч лышвцыцэ ыдшюы лнтдсйаёдыюё лидвчбйдэ «йюшоупчущдд ЙОЙ» ю шоуплз (ачьцъчдзцз лсалвчьлъцз нолшалылз йой жйрвлнолшалылз). Ивй кылз йюилояьлъчайд лсалвчьлългл нолшалыч, ъ нлояжйаюыъд юохпчдъ, адбдодюллнвчьал, ычш шчш ывднхдыюё, пылнц шоуп нцо ычшлгл ед вчьздвч, пыл й лышвцыцэ ыдшюы. Ычшед ывднхдыюё, пылнц шоуп нцо чнюлоуыал юохпчэацз, ивйздаёоюё ылояшл лсйа вчь й фвчайоюё ъ юдшвдыд лы ъюдф, швлзд илохпчыдоё й лыивчъйыдоё. Ъ юъёьй ю кыйз шлзздвпдюшлд ивйздадайд жйрвч Ъдвачзч ад ычш вчюивлюывчадал ъ лыойпйд лы юфдз ю лышвцыцз шоуплз й ла йюилояьхдыюё, ъ люалъалз, соё идвдсчпй юллнщдайэ люлнлэ ъчеалюый глюхсчвюыъдаацзй юывхшыхвчзй.

